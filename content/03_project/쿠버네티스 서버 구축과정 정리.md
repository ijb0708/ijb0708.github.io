
### ğŸ“Œ 1. í´ëŸ¬ìŠ¤í„° êµ¬ì„± ë° ì´ˆê¸° ì„¤ì •

#### ğŸ”¹ ì‚¬ìš© í™˜ê²½

- Proxmox ê¸°ë°˜ VM í™˜ê²½ì—ì„œ Kubernetes êµ¬ì„±
    
- k3s ì´ìš©: ê²½ëŸ‰í™”ëœ K8s ë°°í¬íŒ (ë§ˆìŠ¤í„° 1ê°œ, ì›Œì»¤ë…¸ë“œ 1~2ê°œ, ìŠ¤í† ë¦¬ì§€ ë…¸ë“œ 1ê°œ)
    
- ë‚´ë¶€ë§ì—ì„œ ìš´ì˜ë˜ë©°, VPN í™˜ê²½ ë‚´ì—ì„œ ë§ˆìŠ¤í„° ë…¸ë“œë¡œ ì ‘ì†
    

#### ğŸ”¹ ì„¤ì¹˜ ì ˆì°¨ ë° ì£¼ìš” ì²´í¬ ì‚¬í•­

- `k3s` ì„¤ì¹˜ í›„ `kubectl` ì„¤ì • íŒŒì¼ì„ `/etc/rancher/k3s/k3s.yaml` ê²½ë¡œì—ì„œ í™•ë³´
    
- ì™¸ë¶€ì—ì„œ Lensë‚˜ kubectl í´ë¼ì´ì–¸íŠ¸ë¡œ ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ `server` í•­ëª©ì„ ë‚´ë¶€ IPë¡œ ìˆ˜ì •
    
- ë§ˆìŠ¤í„° ë…¸ë“œì™€ ì›Œì»¤ ë…¸ë“œ ê°„ í†µì‹ ì„ ìœ„í•œ í¬íŠ¸ í™•ì¸: 6443, 10250, 30000~32767 (NodePort)
    

#### ğŸ”¹ SSH ë° sudo ê´€ë¦¬

- ë§ˆìŠ¤í„° ë…¸ë“œì—ì„œë§Œ `kubectl` ì‘ì—…ì„ ì§„í–‰í•˜ë©°, sudo í•„ìš” ì—¬ë¶€ íŒë‹¨ í›„ `~/.kube/config` ì„¤ì •
    
- `$KUBECONFIG` í™˜ê²½ë³€ìˆ˜ì— `/etc/rancher/k3s/k3s.yaml`ë¥¼ ì„¤ì •í•´ ì§€ì†ì ì¸ ê¶Œí•œ ìœ ì§€
    

---

### ğŸ“Œ 2. Longhorn ìŠ¤í† ë¦¬ì§€ êµ¬ì„± ë° ë…¸ë“œ ì—­í•  ë¶„ë¦¬

#### ğŸ”¹ Longhorn ì„¤ì¹˜ ë° ì„¸íŒ…

- Helmìœ¼ë¡œ `longhorn/longhorn` ì°¨íŠ¸ ì„¤ì¹˜:
    
    ```
    helm install longhorn longhorn/longhorn \
      --namespace longhorn-system \
      --set defaultSettings.defaultDataPath="/mnt/longhorn-data1" \
      --set tolerations[0].key="node-role.kubernetes.io/storage" \
      --set tolerations[0].operator="Equal" \
      --set tolerations[0].value="true" \
      --set tolerations[0].effect="NoSchedule"
    ```
    
- `/mnt/longhorn-data1` ë””ë ‰í† ë¦¬ë¥¼ ë§ˆìš´íŠ¸í•  ìŠ¤í† ë¦¬ì§€ ë””ìŠ¤í¬ëŠ” UUID ê¸°ì¤€ìœ¼ë¡œ `/etc/fstab`ì— ê³ ì • ë“±ë¡
    

#### ğŸ”¹ iscsi ì„¸íŒ…

- Longhornì€ iSCSIë¥¼ í†µí•´ ë³¼ë¥¨ì„ ì—°ê²°í•˜ë¯€ë¡œ `open-iscsi` íŒ¨í‚¤ì§€ë¥¼ ëª¨ë“  ê´€ë ¨ ë…¸ë“œì— ì„¤ì¹˜
    
- ì„¤ì¹˜ ì—¬ë¶€ í™•ì¸ ëª…ë ¹ì–´:
    
    ```
    dpkg -l | grep open-iscsi
    systemctl status iscsid
    ```
    

#### ğŸ”¹ ë…¸ë“œ êµ¬ì„± ë° ì—­í•  êµ¬ë¶„

- ë§ˆìŠ¤í„° ë…¸ë“œ: `Node Scheduling = false`, `Disk Scheduling = false`
    
- ì¼ë°˜ ì›Œì»¤ ë…¸ë“œ: í•„ìš”ì— ë”°ë¼ ìŠ¤í† ë¦¬ì§€ ì‚¬ìš©
    
- ìŠ¤í† ë¦¬ì§€ ì „ìš© ë…¸ë“œ: `Node Scheduling = true`, `Disk Scheduling = true`, `Eviction Requested = false`
    

#### ğŸ”¹ ë³¼ë¥¨ ì„¤ì • ì´í•´

- ReplicaëŠ” Longhornì´ ìë™ ë¶„ì‚° ì €ì¥í•˜ë©°, ì„¤ì •ëœ ìŠ¤í† ë¦¬ì§€ ë…¸ë“œë“¤ì— ë³µì œë³¸ì„ ë°°ì¹˜í•¨
    
- `diskTag`, `nodeSelector`, `eviction` ë“±ìœ¼ë¡œ ì„¸ë°€í•œ ì œì–´ ê°€ëŠ¥
    

---

### ğŸ“Œ 3. Kubernetes Dashboard ë° Lens ì„¤ì •

#### ğŸ”¹ Kubernetes Dashboard ì„¤ì¹˜

- ê³µì‹ recommended.yamlë¡œ ì„¤ì¹˜:
    
    ```
    kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v2.7.0/aio/deploy/recommended.yaml
    ```
    
- admin-user ìƒì„±ìš© YAML íŒŒì¼ ì‘ì„± ë° ì ìš©:
    
    ```
    apiVersion: v1
    kind: ServiceAccount
    metadata:
      name: admin-user
      namespace: kubernetes-dashboard
    ---
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      name: admin-user-binding
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: cluster-admin
    subjects:
    - kind: ServiceAccount
      name: admin-user
      namespace: kubernetes-dashboard
    ```
    
- `kubectl port-forward` ë˜ëŠ” `NodePort`ë¥¼ í†µí•´ ì™¸ë¶€ ì ‘ê·¼ ê°€ëŠ¥í•˜ê²Œ ë³€ê²½
    

#### ğŸ”¹ Lens ì„¤ì •

- macOSì—ì„œëŠ” `brew install --cask lens`ë¡œ ì„¤ì¹˜
    
- kubeconfig ê²½ë¡œ: `~/.kube/config`ë¡œ ë³µì‚¬ ë° ìˆ˜ì •
    
    ```
    scp user@master:/etc/rancher/k3s/k3s.yaml ~/.kube/config
    ```
    
- `server: https://127.0.0.1:6443` â†’ ì‹¤ì œ ë§ˆìŠ¤í„° ë…¸ë“œ IPë¡œ ë³€ê²½
    
- Lens ì‹¤í–‰ í›„ ìë™ìœ¼ë¡œ í´ëŸ¬ìŠ¤í„° ì—°ê²°ë¨
    

#### ğŸ”¹ Lensì—ì„œ í™•ì¸í•  ìˆ˜ ìˆëŠ” í•­ëª©

- Nodes: CPU, ë©”ëª¨ë¦¬, Schedulable ìƒíƒœ, ì—­í• 
    
- Workloads: Pod, Deployment, DaemonSet, StatefulSet
    
- Storage: PVC, PV, StorageClass, Snapshot
    
- Networking: Services, Ingress, Endpoints
    
- Custom Resources: longhorn.volumes ë“±
    

---

### ğŸ“Œ 4. ìŠ¤í† ë¦¬ì§€ ê°€ìš©ì„± ë° ë§ˆìš´íŠ¸ ê´€ë ¨ ê³ ë ¤ì‚¬í•­

#### ğŸ”¹ ì¬ë¶€íŒ… ì‹œ ì£¼ì˜ì‚¬í•­

- `/etc/fstab`ì— UUIDë¡œ ë§ˆìš´íŠ¸ ë“±ë¡ë˜ì–´ ìˆì–´ì•¼ í•¨
    
- Longhorn ë³¼ë¥¨ ë§ˆìš´íŠ¸ ì‹¤íŒ¨ ì‹œ PVC ìƒíƒœê°€ `Pending`, PodëŠ” `CrashLoopBackOff` ê°€ëŠ¥
    
- IPê°€ ë³€ê²½ë˜ë©´ kubeconfigì—ì„œ server ì£¼ì†Œê°€ ì¼ì¹˜í•´ì•¼ Lens/kubectl ì ‘ì† ê°€ëŠ¥
    

#### ğŸ”¹ Eviction / Scheduling ì œì–´

- `Eviction Requested: true` â†’ í•´ë‹¹ ë…¸ë“œì—ì„œ Replica ì œê±° í›„ ë‹¤ë¥¸ ë…¸ë“œë¡œ ì´ë™
    
- `Node Scheduling`, `Disk Scheduling` ëª¨ë‘ false â†’ Replica ìƒì„± ì•ˆ í•¨
    
- `schedulable` ì˜µì…˜ìœ¼ë¡œ ìŠ¤í† ë¦¬ì§€ ë¶„ì‚° ì—¬ë¶€ ì œì–´ ê°€ëŠ¥
    

---

### ğŸ“Œ 5. í–¥í›„ ê³„íš ë° ë‹¤ìŒ ë‹¨ê³„

#### ğŸ”¹ Ingress êµ¬ì„± ì˜ˆì •

- ì—¬ëŸ¬ ì„œë¹„ìŠ¤ì— ëŒ€í•´ í¬íŠ¸ ëŒ€ì‹  ë„ë©”ì¸ ê¸°ë°˜ ì ‘ê·¼ êµ¬ì„±
    
- Traefik(ê¸°ë³¸), ë˜ëŠ” nginx-ingress ì„¤ì¹˜ ì˜ˆì •
    
- Ingress ë¦¬ì†ŒìŠ¤ YAML ì‘ì„± í›„ hosts íŒŒì¼ê³¼ ì—°ë™
    

#### ğŸ”¹ ë¡œê¹…/ëª¨ë‹ˆí„°ë§ ë„êµ¬ ì ìš©

- kube-ops-view: ì‹¤ì‹œê°„ ë…¸ë“œ/Pod ì‹œê°í™”
    
- stern: ë¡œê·¸ ì‹¤ì‹œê°„ tail
    
- k9s: í„°ë¯¸ë„ ê¸°ë°˜ ë¦¬ì†ŒìŠ¤ ë¸Œë¼ìš°ì§•
    
- ì´í›„ Grafana, Loki ë„ì… ê²€í†  ê°€ëŠ¥

ì´ì „ê¹Œì§€ ì§„í–‰ì‚¬í•­

## ingress ì§„í–‰

ì¢‹ì•„, ê·¸ëŸ¼ ì§€ê¸ˆë¶€í„° **Ingress ì„¤ì •** ë°”ë¡œ ë“¤ì–´ê°€ì.  
â†’ ì´ê±´ ë„ˆê°€ ë§Œë“  ì—¬ëŸ¬ ì„œë¹„ìŠ¤ë¥¼ **ë„ë©”ì¸ ë˜ëŠ” ê²½ë¡œ ê¸°ë°˜ìœ¼ë¡œ ì ‘ê·¼ ê°€ëŠ¥í•˜ê²Œ ë§Œë“œëŠ” í•µì‹¬ ì‘ì—…**ì´ì•¼. ğŸŒ

---

ì¢‹ì€ ì§ˆë¬¸ì´ì•¼!  
Traefikê³¼ Nginx Ingress ControllerëŠ” ë‘˜ ë‹¤ **ì¿ ë²„ë„¤í‹°ìŠ¤ì—ì„œ Ingress(ë„ë©”ì¸ ë¼ìš°íŒ…)ë¥¼ ì²˜ë¦¬í•˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬**ì¸ë°,  
ì„±ê²©ê³¼ ì² í•™ì´ ê½¤ ë‹¬ë¼. ğŸ”

---

## âœ… í•µì‹¬ ì°¨ì´ ìš”ì•½

|í•­ëª©|**Nginx Ingress**|**Traefik Ingress**|
|---|---|---|
|ğŸ§  ì„¤ì • ë°©ì‹|**Ingress ë¦¬ì†ŒìŠ¤ ìœ„ì£¼**|**Ingress + CRD(Custom Resource Definitions)**|
|ğŸ“¦ êµ¬ì„± ë°©ì‹|ë‹¨ìˆœí•˜ê³  ì „í†µì ì¸ ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ|ë™ì , ìë™ íƒì§€, ì´ë²¤íŠ¸ ê¸°ë°˜|
|ğŸ“Š ì‹œê°í™” ëŒ€ì‹œë³´ë“œ|âŒ ì—†ìŒ (ìˆ˜ë™ìœ¼ë¡œ ì—°ë™ ê°€ëŠ¥)|âœ… ì›¹ UI ìˆìŒ (ê¸°ë³¸ ì œê³µ)|
|ğŸ§° ì»¤ìŠ¤í„°ë§ˆì´ì§•|ìµìˆ™í•œ nginx.conf ìŠ¤íƒ€ì¼|íƒœê·¸ ê¸°ë°˜ ë¼ìš°íŒ…, ë‹¤ì–‘í•œ ì–´ë…¸í…Œì´ì…˜|
|âš™ï¸ ë³µì¡í•œ ë¼ìš°íŒ…|ëœ ìœ ì—° (ë‹¨ìˆœ path/host)|ë§¤ìš° ìœ ì—° (path, host, í—¤ë” ê¸°ë°˜ ë“±)|
|ğŸ£ ë°°í¬ ë³µì¡ë„|ë§¤ìš° ë„ë¦¬ ì“°ì´ê³  ë¬¸ì„œ ë§ìŒ|ì•½ê°„ ìƒì†Œí•  ìˆ˜ ìˆì§€ë§Œ k3s ê¸°ë³¸ íƒ‘ì¬|
|âš¡ ë°˜ì‘ì„±|configmap ê¸°ë°˜, ëŠë¦´ ìˆ˜ ìˆìŒ|ì´ë²¤íŠ¸ ê¸°ë°˜ â†’ ë¹ ë¥´ê²Œ ë¼ìš°íŒ… ê°±ì‹ |
|ğŸ§© TLS ì—°ë™|cert-managerì™€ ìˆ˜ë™ í†µí•©|Let's Encrypt ìë™ í†µí•© ê°€ëŠ¥|

---

## âœ… ì–´ë–¤ ê±¸ ì„ íƒí•˜ë©´ ì¢‹ì„ê¹Œ?

|ë„ˆ ìƒí™©|ì¶”ì²œ|
|---|---|
|âš¡ ë¹ ë¥¸ í…ŒìŠ¤íŠ¸, ê°„ë‹¨í•œ ì„¤ì •|**Nginx**|
|ğŸ§  ì´ë²¤íŠ¸ ê¸°ë°˜, ìë™í™” ì§€í–¥|**Traefik**|
|ğŸ” ê°€ì‹œì„± ìˆëŠ” ìš´ì˜, ëŒ€ì‹œë³´ë“œ|**Traefik**|
|ğŸ“œ ì „í†µì ì¸ nginxì— ìµìˆ™|**Nginx**|
|ğŸ’¡ k3s ê¸°ë³¸ êµ¬ì„± ê·¸ëŒ€ë¡œ ì‚¬ìš©|**Traefik (ì´ë¯¸ ì„¤ì¹˜ë¨ì¼ ìˆ˜ë„ ìˆìŒ)**|

---

## âœ… ì°¸ê³ : Traefikì€ k3s ì„¤ì¹˜ ì‹œ **ê¸°ë³¸ìœ¼ë¡œ ê°™ì´ ì„¤ì¹˜ë˜ëŠ” ê²½ìš°ê°€ ë§ì•„**

í™•ì¸í•´ë³´ì:

```bash
kubectl get pods -A | grep traefik
```

ë§Œì•½ ì´ë¯¸ ë–  ìˆë‹¤ë©´ êµ³ì´ nginx ì„¤ì¹˜ ì•ˆ í•˜ê³  Traefik ê·¸ëŒ€ë¡œ ì¨ë„ ë¼.

---

## ğŸ¯ ê²°ë¡ 

- ğŸ”§ **ê°„ë‹¨í•œ path ê¸°ë°˜ ë¼ìš°íŒ…, ìµìˆ™í•œ nginx ìŠ¤íƒ€ì¼ â†’ nginx-ingress**
    
- ğŸŒ **ìë™ íƒì§€, ëŒ€ì‹œë³´ë“œ, ì´ë²¤íŠ¸ ê¸°ë°˜ ìš´ì˜ â†’ Traefik**
    

---

ë„ˆê°€ ì•ìœ¼ë¡œ ìš´ì˜ ìª½ê¹Œì§€ í™•ì¥í•  ìƒê°ì´ë¼ë©´ Traefikë„ ê½¤ ë§¤ë ¥ì ì¸ ì„ íƒì´ì•¼.  
í•œ ë²ˆ ì¨ë³´ë©´ â€œìë™ìœ¼ë¡œ ë‹¤ ë¼ë²„ë¦¬ëŠ” ëŠë‚Œâ€ì´ ì¢€ ìˆì–´ ğŸ˜

ë‘˜ ì¤‘ í•˜ë‚˜ ê³¨ë¼ì„œ ì§€ê¸ˆ ë°”ë¡œ Ingress êµ¬ì„± ë„ì™€ì¤„ê²Œ â€” ì–´ë–¤ ìª½ì´ ë‹¹ê²¨?

## âœ… 1. í˜„ì¬ ìƒíƒœ í™•ì¸

ë¨¼ì € í™•ì¸í•  ê±´ ì´ê±°ì•¼:

|í•­ëª©|ì„¤ëª…|í™•ì¸ ë°©ë²•|
|---|---|---|
|âœ… Ingress Controller ì„¤ì¹˜ ì—¬ë¶€|Traefik or Nginx|`kubectl get pods -A|
|âœ… ClusterIP or NodePort ì„¤ì • ì—¬ë¶€|ì™¸ë¶€ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•œê°€?|`kubectl get svc -A|
|âœ… ì‚¬ìš©í•  ë„ë©”ì¸|ì˜ˆ: `app.local`, `dashboard.local`|`/etc/hosts` ìˆ˜ì • í•„ìš” (ë¡œì»¬ í…ŒìŠ¤íŠ¸ìš©)|

---

## âœ… 2. Ingress Controller ì„¤ì¹˜ (nginxë¡œ ì˜ˆì‹œ)

### ğŸ‘‰ nginx-ingress ì„¤ì¹˜ (Helm)

```bash
helm repo add ingress-nginx https://kubernetes.github.io/ingress-nginx
helm repo update

helm install ingress-nginx ingress-nginx/ingress-nginx \
  --namespace ingress-nginx \
  --create-namespace
```

ì„¤ì¹˜ í›„ í™•ì¸:

```bash
kubectl get pods -n ingress-nginx
kubectl get svc -n ingress-nginx
```

NodePortê°€ ì—´ë ¤ ìˆëŠ”ì§€ í™•ì¸!

---

## âœ… 3. ì„œë¹„ìŠ¤ í•˜ë‚˜ Ingressë¡œ ë…¸ì¶œí•˜ê¸° (ì˜ˆ: nginx-test)

ë¨¼ì € í…ŒìŠ¤íŠ¸ìš© ì„œë¹„ìŠ¤ ë§Œë“¤ì—ˆì„ ê±°ì•¼:

```bash
kubectl create deployment nginx-test --image=nginx
kubectl expose deployment nginx-test --port=80 --type=ClusterIP
```

---

## âœ… 4. Ingress ë¦¬ì†ŒìŠ¤ ìƒì„±

```yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: nginx-test-ingress
  namespace: default
  annotations:
    nginx.ingress.kubernetes.io/rewrite-target: /
spec:
  rules:
    - host: nginx.local
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: nginx-test
                port:
                  number: 80
```

ì ìš©:

```bash
kubectl apply -f nginx-ingress.yaml
```

---

## âœ… 5. `/etc/hosts` ì„¤ì • (ë¡œì»¬ì—ì„œ nginx.localë¡œ ì ‘ì† ê°€ëŠ¥í•˜ê²Œ)

```plaintext
<Ingress Controllerì˜ IP ë˜ëŠ” ë…¸ë“œ IP>  nginx.local
```

ì˜ˆ:

```plaintext
192.168.0.50  nginx.local
```

ê·¸ ë‹¤ìŒ ë¸Œë¼ìš°ì €ì—ì„œ `http://nginx.local` ì ‘ì† â†’ Nginx í˜ì´ì§€ê°€ ëœ¨ë©´ ì„±ê³µ ğŸ‰

---

## âœ… ìš”ì•½

|ë‹¨ê³„|ì„¤ëª…|
|---|---|
|â‘  Ingress Controller ì„¤ì¹˜|Traefik or nginx|
|â‘¡ ì„œë¹„ìŠ¤ ìƒì„±|nginx-test ë“±|
|â‘¢ Ingress ë¦¬ì†ŒìŠ¤ ìƒì„±|ë„ë©”ì¸ ê¸°ë°˜ ì ‘ê·¼ ì„¤ì •|
|â‘£ `/etc/hosts` ìˆ˜ì •|ë¡œì»¬ ë„ë©”ì¸ ì—°ê²°|

---

ì§„ì… í™•ì¸ í›„, ë‹¤ìŒì—” Dashboardë‚˜ Longhornë„ ë„ë©”ì¸ìœ¼ë¡œ ë¶™ì¼ ìˆ˜ ìˆì–´.

ì§€ê¸ˆ Ingress Controllerë¡œ Traefik ì“¸ì§€ nginx ì“¸ì§€ ì •í•´ì¡Œì–´?  
ë˜ëŠ” ìœ„ Helm ë°©ì‹ ë°”ë¡œ ì“¸ê¹Œ? ğŸ˜