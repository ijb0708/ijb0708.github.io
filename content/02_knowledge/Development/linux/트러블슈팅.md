---
tags:
  - longborn
  - kubernetes
  - linux
---

# longborn ì—ëŸ¬ëª¨ìŒ

## iSCSI ë¯¸ì„¤ì¹˜ ë¬¸ì œ
### - ë¬¸ì œ ì›ì¸
```
fatal msg="...please make sure you have iscsiadm/open-iscsi installed on the host..."
```

> ğŸ“Œ **Longhornì€ ë‚´ë¶€ì ìœ¼ë¡œ iSCSIë¥¼ ì‚¬ìš©í•´ì„œ ë¸”ë¡ ë””ë°”ì´ìŠ¤ë¥¼ ì—°ê²°**í•˜ëŠ”ë°,  
> â†’ **`iscsiadm` (open-iscsi)** íŒ¨í‚¤ì§€ê°€ ì„¤ì¹˜ë˜ì–´ ìˆì§€ ì•Šì•„ì„œ longhorn-managerê°€ ì‹¤í–‰ë˜ì§€ ëª»í•˜ê³  ìˆìŒ.

### - í•´ê²° ë°©ë²•: `open-iscsi` ì„¤ì¹˜
```bash
sudo apt update
sudo apt install -y open-iscsi
sudo systemctl enable --now iscsid
```

â†’ ëª¨ë“  **Longhornì´ ì„¤ì¹˜ëœ ë…¸ë“œ(ì¦‰, longhorn-managerê°€ ì‹¤í–‰ ë…¸ë“œ ì „ë¶€)ì— ì´ê±¸ ì„¤ì¹˜ ì´í›„ systemctlë¡œ ì—°ê²°

### - í™•ì¸ë°©ë²•
```bash
kubectl -n longhorn-system get pods
```

â†’ CrashLoopBackOff ìƒíƒœê°€ ì‚¬ë¼ì§€ê³  `Running`ìœ¼ë¡œ ë°”ë€ŒëŠ”ì§€ í™•ì¸

---
# ë¦¬ëˆ…ìŠ¤ ì—ëŸ¬ëª¨ìŒ
## fastab ì˜ëª»ëœ ì„¤ì •ì´í›„ ë¶€íŒ…ë¶ˆê°€ í˜„ìƒ
### - ë°©ë²• 1: root ì‰˜(ë¹„ìƒ ì…¸) ì§„ì…

ì¬ë¶€íŒ… í›„ ì•„ë˜ì²˜ëŸ¼ ë‚˜ì˜¬ë•Œ:

```
You are now in emergency mode.
Give root password for maintenance
(or press Control-D to continue):
```

â†’ ì—¬ê¸°ì„œ **root ë¹„ë°€ë²ˆí˜¸ ì…ë ¥** ì´í›„, ì‰˜ë¡œ ì§„ì…

```bash
vi /etc/fstab
```

â†’ ì˜ëª»ëœ ì¤„ ìˆ˜ì •í•˜ê±°ë‚˜, `#`ìœ¼ë¡œ ì£¼ì„ ì²˜ë¦¬

â†’ ì €ì¥ í›„ ì¬ë¶€íŒ…

```bash
reboot
```
### - ë°©ë²• 2: ë¶€íŒ… ì‹œ `GRUB`ì—ì„œ ìˆ˜ë™ ë³µêµ¬

1. ë¶€íŒ… ì‹œ `Grub` ë©”ë‰´ ëœ° ë•Œ `e` í‚¤ ëˆŒëŸ¬
    
2. `linux` ì»¤ë„ ì¤„ ëì— ë‹¤ìŒ ì¶”ê°€:

```
systemd.unit=emergency.target
```

3. `Ctrl + X` ë˜ëŠ” `F10` ëˆŒëŸ¬ ë¶€íŒ…
    
4. ìœ„ì™€ ê°™ì€ root ì…¸ë¡œ ë“¤ì–´ê° â†’ ìˆ˜ì •

### - ì˜ˆë°©ë²•: fstabì—ì„œ ìë™ ë§ˆìš´íŠ¸ ì‹¤íŒ¨í•´ë„ ë¶€íŒ…í•˜ê²Œ í•˜ë ¤ë©´

ë‹¤ìŒì²˜ëŸ¼ `nofail` ë˜ëŠ” `defaults,nofail` ì˜µì…˜ì„ ì¶”ê°€í•˜ë©´  
â†’ **ì‹¤íŒ¨í•´ë„ ë¶€íŒ… ìì²´ëŠ” ì§„í–‰ë¼**:

```fstab
UUID=xxxx-xxxx /mnt/longhorn-data ext4 defaults,nofail 0 2
```
---